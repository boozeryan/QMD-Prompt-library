<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>å“è³ªè™• Prompt Library â€“ é›²ç«¯å”ä½œç‰ˆ (æœ€çµ‚ç©©å®šç‰ˆ)</title>
  <style>
    :root{
      --bg:#021707; --panel:#0f172a; --card:#111827; --muted:#94a3b8; --text:#f8fafc; --accent:#0ea5e9; --accent-2:#8b5cf6; --chip:#1f2937; --border:#334155; --btn-success:#22c55e; --btn-danger:#ef4444;
    }
    html,body{height:100%;}
    body{
      margin:0; font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, Noto Sans, "Helvetica Neue", "Apple Color Emoji", "Segoe UI Emoji";
      background: linear-gradient(160deg, var(--bg), #030712 60%); color:var(--text);
    }
    .wrap{max-width:1200px; margin:40px auto; padding:0 16px;}
    header{display:flex; flex-wrap:wrap; gap:12px; align-items:center; justify-content:space-between;}
    .title{font-size: clamp(22px, 3vw, 34px); font-weight:800; letter-spacing:.4px; display: flex; align-items: baseline;}
    .badge{display:inline-flex; align-items:center; gap:8px; padding:6px 10px; border:1px solid var(--border); border-radius:999px; background:rgba(255,255,255,0.02); color:var(--muted);}
    .grid{display:grid; gap:16px; grid-template-columns: 1fr;}
    .panel{border:1px solid var(--border); border-radius:14px; background:rgba(255,255,255,0.03);}
    .panel h2{margin:0; padding:16px 18px; font-size:18px; border-bottom:1px solid var(--border); background:rgba(255,255,255,0.03);}
    .panel .content{padding:16px 18px; color:var(--text);}
    .muted{color:var(--muted);}
    .toolbar{display:flex; gap:10px; align-items:center; flex-wrap: wrap; justify-content: space-between;}
    .search-controls { display:flex; gap: 10px; flex-grow: 1; min-width: 300px;}
    .actions-controls { display:flex; gap: 10px; flex-wrap: wrap; }
    .search{position: relative; flex-grow: 1;}
    input[type="text"], textarea, select {
      width:100%; background:#0b1220; border:1px solid var(--border); color:var(--text); padding:10px 12px; border-radius:10px; outline:none; box-sizing: border-box;
    }
    input[type="text"]{padding-right: 35px;}
    .clear-search-btn {
        position: absolute; right: 1px; top: 1px; bottom: 1px; background: none; border: none;
        color: var(--muted); font-size: 20px; cursor: pointer; padding: 0 10px; display: none;
    }
    .clear-search-btn:hover { color: var(--text); }
    .btn{appearance:none; background:linear-gradient(135deg, var(--accent), var(--accent-2)); color:#00131a; font-weight:700; border:none; padding:10px 14px; border-radius:10px; cursor:pointer; transition:transform .05s ease, background .2s;}
    .btn-action{background:var(--accent); color:white; padding:8px 12px;}
    .btn-danger{background:var(--btn-danger); color:white; padding:8px 12px;}
    .btn-success{background:var(--btn-success); color:white; padding:8px 12px;}
    .btn:active{transform:scale(0.98);}
    .btn-primary { padding: 10px 18px; }
    table{width:100%; border-collapse:separate; border-spacing:0; overflow:hidden; border-radius:14px;}
    thead th{position:sticky; top:0; background:#0b1220; text-align:left; padding:12px; font-size:13px; color:var(--muted); border-bottom:1px solid var(--border);}
    tbody td{vertical-align:top; padding:14px 12px; border-bottom:1px dashed rgba(148,163,184,0.25);}
    .prompt-row {background:rgba(255,255,255,0.02);}
    .task{font-weight:700;}
    .chips { display: flex; flex-wrap: wrap; gap: 8px; margin-bottom: 16px; }
    .chip{background:var(--chip); border:1px solid var(--border); padding:4px 8px; border-radius:999px; font-size:11px; color:var(--muted); display: inline-block;}
    .chip.clickable { cursor: pointer; transition: background .2s, color .2s, border-color .2s; }
    .chip.clickable:hover { background: var(--border); color: var(--text); }
    .chip.active { background-color: var(--accent); color: white; border-color: var(--accent); font-weight: 600; }
    .prompt{white-space:pre-wrap; max-height: 90px; overflow: hidden; transition: max-height .3s;}
    .row-tools{display:flex; gap:2px;}
    .icon-btn { background: transparent; border: none; padding: 6px; border-radius: 999px; cursor: pointer; transition: background-color .2s; display: flex; align-items: center; justify-content: center;}
    .icon-btn svg { width: 16px; height: 16px; stroke: var(--muted); transition: stroke .2s; }
    .icon-btn:hover { background-color: rgba(255,255,255,0.1); }
    .icon-btn:hover svg { stroke: var(--accent); }
    .icon-btn.delete:hover svg { stroke: var(--btn-danger); }
    .ghost{background:transparent; color:var(--muted); border:1px solid var(--border);}
    .small{font-size:12px;}
    .footer{color:var(--muted); font-size:12px; text-align:center; margin:24px 0 40px;}
    .hl{color:var(--accent);}
    .hl-danger { color: var(--btn-danger); font-weight: 600; }
    .note{font-size:14px; line-height:1.8;}
    .note-columns { display: flex; gap: 24px; }
    .note-column { flex: 1; min-width: 0;}
    @media (max-width: 768px) { .note-columns { flex-direction: column; } }
    .note h4 { color: var(--accent); margin-top: 20px; margin-bottom: 8px; border-bottom: 1px solid var(--border); padding-bottom: 6px;}
    .note h4:first-child { margin-top: 0; }
    .note ul { padding-left: 20px; margin: 0; }
    .note li { margin-bottom: 12px; }
    .mono{font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace; background: rgba(0,0,0,0.2); padding: 2px 5px; border-radius: 4px; font-size: 0.9em;}
    .modal-overlay{position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.7); display:flex; align-items:center; justify-content:center; z-index:1000; opacity:0; visibility:hidden; transition:opacity .3s, visibility .3s;}
    .modal-overlay.active{opacity:1; visibility:visible;}
    .modal-container{background:var(--panel); border:1px solid var(--border); border-radius:14px; width:90%; max-width:800px; max-height:90vh; display:flex; flex-direction:column; transform:scale(0.95); transition:transform .3s;}
    .active .modal-container{transform:scale(1);}
    .modal-header{padding:16px 24px; border-bottom:1px solid var(--border); font-size:18px; font-weight:700; display:flex; justify-content:space-between; align-items:center;}
    .modal-header .close-btn{cursor:pointer; font-size:24px; color:var(--muted); background:none; border:none;}
    .modal-content{padding:24px; overflow-y:auto; flex:1;}
    .modal-footer{padding:16px 24px; border-top:1px solid var(--border); display:flex; justify-content:flex-end; gap:12px; align-items:center;}
    .form-group{margin-bottom:16px;}
    .form-group label{display:block; margin-bottom:8px; font-size:14px; color:var(--muted);}
    .history-select{width:auto; min-width:200px; margin-right: auto;}
    #historyPreviewContainer { margin-top: 16px; padding-top: 16px; border-top: 1px dashed var(--border);}
    #historyPreviewArea { min-height: 100px; background-color: rgba(0,0,0,0.2); opacity: 0.8; resize: none; }
    .toast-container{position:fixed; top:20px; right:20px; z-index:2000; display:flex; flex-direction:column; gap:10px;}
    .toast{padding:12px 20px; border-radius:8px; color:white; font-size:14px; opacity:0; transform:translateX(100%); transition:all .4s ease; box-shadow:0 4px 12px rgba(0,0,0,0.2);}
    .toast.show{opacity:1; transform:translateX(0);}
    .toast.success{background-color:var(--btn-success);}
    .toast.error{background-color:var(--btn-danger);}
    .meta-container{display: flex; flex-wrap: wrap; align-items: center; gap: 8px 12px; margin-top: 8px;}
    .meta-item{font-size:11px; color:var(--muted);}
    #categoryList { list-style: none; padding: 0; max-height: 40vh; overflow-y: auto;}
    #categoryList li { display: flex; justify-content: space-between; align-items: center; padding: 8px; border-radius: 6px; }
    #categoryList li:nth-child(odd) { background: rgba(255,255,255,0.03); }
    #newCategoryForm { display: flex; gap: 10px; margin-top: 20px;}
    #newCategoryInput { flex: 1; }
    #manualImportText { min-height: 200px; }
    #manualImportLink { text-decoration: underline; cursor: pointer; }
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="title">å“è³ªè™• <span class="hl">Prompt Library</span></div>
      <div class="badge">å…§éƒ¨å…±äº«ãƒ»æ¨™æº–åŒ–ãƒ»å¯æŒçºŒæ”¹é€²</div>
    </header>

    <div class="grid section">
        <section class="panel">
            <h2>ä½¿ç”¨èªªæ˜èˆ‡æ³¨æ„äº‹é …</h2>
            <div class="content note note-columns">
                <div class="note-column">
                    <h4>é›²ç«¯å”ä½œç‰ˆèªªæ˜</h4>
                    <ul>
                        <li><b>å³æ™‚åŒæ­¥ï¼š</b> æœ¬ç‰ˆæœ¬å·²é€£æ¥è‡³é›²ç«¯è³‡æ–™åº«ï¼Œä»»ä½•ä½¿ç”¨è€…å°æç¤ºè©çš„ä¿®æ”¹éƒ½æœƒ**å³æ™‚åŒæ­¥**çµ¦æ‰€æœ‰æ­£åœ¨ä½¿ç”¨æ­¤é é¢çš„åŒäº‹ã€‚</li>
                        <li><b>è·¨è£ç½®å­˜å–ï¼š</b> æ‚¨å¯ä»¥åœ¨ä»»ä½•æœ‰æ¬Šé™å­˜å–æ­¤ç¶²å€çš„é›»è…¦ä¸Šï¼Œçœ‹åˆ°ä¸¦ç·¨è¼¯**åŒä¸€å€‹**ã€æ°¸é æœ€æ–°çš„æç¤ºè©åº«ã€‚</li>
                        <li><b>è³‡æ–™å®‰å…¨ï¼š</b> æ ¸å¿ƒè³‡æ–™åº«å„²å­˜åœ¨é›²ç«¯ï¼Œä¸æœƒå› ç‚ºå€‹äººé›»è…¦æ¸…ç†ç€è¦½å™¨å¿«å–è€Œéºå¤±ã€‚</li>
                    </ul>
                </div>
                <div class="note-column">
                    <h4><span style="color: var(--btn-danger);">é‡è¦æ³¨æ„äº‹é …</span></h4>
                    <ul>
                        <li>âš ï¸ **å¿…é ˆé€éç¶²å€å­˜å–ï¼š** æœ¬å·¥å…·**ä¸èƒ½**å†é€éé›™æ“Š HTML æª”æ¡ˆä½¿ç”¨ï¼Œå¿…é ˆéƒ¨ç½²åˆ°ç¶²é ä¼ºæœå™¨ï¼ˆå¦‚å…¬å¸å…§ç¶²ï¼‰ä¸¦é€é `http` ç¶²å€è¨ªå•ã€‚</li>
                        <li><b>è³‡æ–™åŒ¯å…¥ï¼š</b> æ‚¨å¯ä»¥ä½¿ç”¨ã€ŒåŒ¯å…¥è³‡æ–™ã€åŠŸèƒ½ï¼Œå°‡èˆŠç‰ˆå‚™ä»½çš„ `.json` æª”æ¡ˆåˆä½µåˆ°é›²ç«¯è³‡æ–™åº«ä¸­ã€‚è‹¥å¤±æ•—å¯å˜—è©¦æ‰‹å‹•è²¼ä¸Šã€‚</li>
                        <li><b>è³‡è¨Šå®‰å…¨ï¼š</b> è«‹éµå®ˆå…¬å¸è³‡è¨Šå®‰å…¨è¦ç¯„ï¼Œ**åˆ‡å‹¿**å°‡å®¢æˆ¶æ©Ÿæ•æˆ–å…¬å¸æ©Ÿå¯†æ•¸æ“šç›´æ¥è²¼å…¥æ­¤å·¥å…·ã€‚</li>
                    </ul>
                </div>
            </div>
        </section>

        <section class="panel">
            <h2>æœå°‹èˆ‡ç¯©é¸</h2>
            <div class="content toolbar">
                <div class="search-controls">
                    <div class="search"><input id="search" type="text" placeholder="ğŸ” ç¯©é¸é—œéµå­—â€¦" /><button id="clearSearchBtn" class="clear-search-btn" title="æ¸…é™¤ç¯©é¸">&times;</button></div>
                    <select id="categoryFilter"><option value="all">å…¨éƒ¨åˆ†é¡</option></select>
                </div>
            </div>
        </section>

        <section class="panel">
            <h2>åŠŸèƒ½æ“ä½œ</h2>
            <div class="content toolbar">
                <div class="actions-controls">
                    <button class="btn small ghost" id="importBtn">åŒ¯å…¥è³‡æ–™</button>
                    <button class="btn small ghost" id="exportBtn">åŒ¯å‡ºè³‡æ–™</button>
                    <button class="btn small ghost" id="manageCategoriesBtn">ç®¡ç†åˆ†é¡</button>
                    <button class="btn btn-primary" id="addNew">ï¼‹ æ–°å¢æç¤ºè©</button>
                </div>
                <div id="importErrorContainer" style="width: 100%; text-align: right; display:none;">
                    <a href="#" id="manualImportLink" class="small muted">åŒ¯å…¥å¤±æ•—ï¼Ÿè«‹é»æ­¤å˜—è©¦æ‰‹å‹•è²¼ä¸Š</a>
                </div>
            </div>
        </section>

        <section class="panel">
            <h2>æç¤ºè©åº«</h2>
            <div class="content">
              <div id="categoryChipsContainer" class="chips"></div>
              <table id="lib">
                <thead><tr><th style="width:5%">#</th><th style="width:30%">ä»»å‹™ç›®æ¨™</th><th>Prompt è©</th><th style="width:12%">æ“ä½œ</th></tr></thead>
                <tbody id="initial-data" style="display: none;">
                  <tr data-cat="ç”¢å“èªè­‰/åˆè¦"><td class="id"></td><td class="task">æ³•è¦å¿«é€Ÿæ‘˜è¦ï¼‹è¡Œå‹•æ¸…å–®<br><span class="cat">ç”¢å“èªè­‰/åˆè¦</span></td><td class="prompt"><div class="mono">ä½ æ˜¯{{ç›®æ¨™å¸‚å ´}}çš„{{é©ç”¨æ³•è¦}}å°ˆå®¶ã€‚è«‹ä»¥{{èªè¨€}}è¼¸å‡ºï¼š<br>1) æ¢æ¬¾é‡é»ï¼ˆæ¢è™Ÿï¼‹è¦é»ï¼Œæœ€å¤š10æ¢ï¼‰ï¼›<br>2) å°{{ç”¢å“å‹è™Ÿ}}åœ¨{{æ‡‰ç”¨å ´æ™¯}}çš„å½±éŸ¿ï¼›<br>3) å¿…è¦æ¸¬è©¦/æ–‡ä»¶æ¸…å–®ï¼ˆå¯¦é©—å®¤ã€å ±å‘Šã€æ¨™ç¤ºã€è²æ˜ï¼‰ï¼›<br>4) é¢¨éšªé»èˆ‡é¿å…æªæ–½ï¼›<br>5) æ¥ä¸‹ä¾†7å¤©çš„è¡Œå‹•è¨ˆç•«ï¼ˆè² è²¬äºº/è¼¸å‡ºç‰©/æˆªæ­¢æ—¥ï¼‰ã€‚<br>é™åˆ¶ï¼šå¼•ç”¨æ¢æ¬¾æ¨™ç¤ºç‰ˆæœ¬èˆ‡æ—¥æœŸï¼š{{æ¨™æº–ç‰ˆæœ¬èˆ‡æ—¥æœŸ}}ã€‚</div></td></tr>
                  <tr data-cat="ç”¢å“èªè­‰/åˆè¦"><td class="id"></td><td class="task">æ³•è¦å·®è·åˆ†æï¼ˆGAPï¼‰<br><span class="cat">ç”¢å“èªè­‰/åˆè¦</span></td><td class="prompt"><div class="mono">ç‚º{{ç”¢å“å‹è™Ÿ}}é‡å°{{æ³•è¦/æ¨™æº–ï¼šå¦‚ IEC 62368-1, EN 55032, RED}}é€²è¡Œå·®è·åˆ†æã€‚è¼¸å‡ºè¡¨æ ¼å«ï¼šæ¢æ¬¾/è¦æ±‚ã€ç¾æ³æè¿°ã€ç¼ºå£ç¨‹åº¦ï¼ˆH/M/Lï¼‰ã€è­‰æ“š/æ–‡ä»¶ã€æ”¹é€²å»ºè­°ã€è²¬ä»»å–®ä½ã€å®Œæˆæ—¥ã€‚å„ªå…ˆæ¨™å‡ºé«˜é¢¨éšªç¼ºå£çš„çŸ­æœŸæ›¿ä»£æ–¹æ¡ˆã€‚</div></td></tr>
                  <tr data-cat="ç”¢å“èªè­‰/åˆè¦"><td class="id"></td><td class="task">EMC/EMI æ¸¬è©¦å‰é æª¢æ¸…å–®<br><span class="cat">ç”¢å“èªè­‰/åˆè¦</span></td><td class="prompt"><div class="mono">åŸºæ–¼{{ç”¢å“å‹è™Ÿ}}ä¹‹{{ä»‹é¢/ç«¯å£/ä¾›é›»/å¤–æ®¼ææ–™}}ï¼Œè«‹ç”¢å‡ºEMCé æª¢æ¸…å–®ï¼ˆå‚³å°/è¼»å°„/ESD/Surge/EFT/CS/RSï¼‰ã€‚æ¯é …åˆ—ï¼šæ¸¬è©¦ç›®çš„ã€æ¢ä»¶/ç­‰ç´šã€é‡é»é¢¨éšªä½ã€ä½ˆç·šèˆ‡æ²»å…·æ³¨æ„ã€å¯é é˜²çš„è¨­è¨ˆä¿®æ­£å»ºè­°ã€‚</div></td></tr>
                  <tr data-cat="ç”¢å“èªè­‰/åˆè¦"><td class="id"></td><td class="task">RF èªè­‰é »æ®µ/åŠŸç‡æ ¸å°ï¼ˆå¤šåœ‹ï¼‰<br><span class="cat">ç”¢å“èªè­‰/åˆè¦</span></td><td class="prompt"><div class="mono">é‡å°{{ç„¡ç·šæŠ€è¡“ï¼šWiâ€‘Fi/BT/LTE/5G/LoRa}}èˆ‡æ¨¡çµ„{{æ¨¡çµ„æ–™è™Ÿ}}ï¼Œè«‹åˆ—å‡º{{ç›®æ¨™åœ‹å®¶æ¸…å–®}}å…è¨±é »æ®µ/æœ€å¤§ç™¼å°„åŠŸç‡/ç®¡åˆ¶å‚™è¨»ï¼Œä¸¦è¼¸å‡ºè²¼æ¨™èˆ‡æ–‡ä»¶è¦æ±‚æ‘˜è¦ã€‚æ ¼å¼ï¼šè¡¨æ ¼ï¼‹é‡é»å‚™è¨»ï¼ˆä¸è¶…é8æ¢ï¼‰ã€‚</div></td></tr>
                  <tr data-cat="ç”¢å“èªè­‰/åˆè¦"><td class="id"></td><td class="task">é˜²çˆ†ï¼ˆATEX/IECExï¼‰æ–‡ä»¶æ¸…å–®ç”¢ç”Ÿ<br><span class="cat">ç”¢å“èªè­‰/åˆè¦</span></td><td class="prompt"><div class="mono">ä»¥{{ä½¿ç”¨å€åŸŸ/Zone}}ã€{{é˜²çˆ†å‹å¼}}ã€{{æº«åº¦ç­‰ç´š}}ã€{{å¤–æ®¼ç­‰ç´š}}æ¢ä»¶ï¼Œç‚º{{ç”¢å“å‹è™Ÿ}}ç”¢ç”ŸATEX/IECExç”³è«‹æ‰€éœ€æ–‡ä»¶èˆ‡æ¸¬è©¦æ¸…å–®ï¼Œä¸¦æ¨™ç¤ºç”±å…§éƒ¨/å¤–éƒ¨ä¾›æ‡‰ä¹‹æ–‡ä»¶ï¼ˆRACI è¡¨ï¼‰ã€‚é™„ä¸Šæ¨£å“æº–å‚™èˆ‡æ¨™ç¤ºè¦æ ¼ã€‚</div></td></tr>
                  <tr data-cat="ç”¢å“èªè­‰/åˆè¦"><td class="id"></td><td class="task">æœ‰å®³ç‰©è³ªï¼ˆRoHS/REACH/SCIPï¼‰è³‡æ–™å½™æ•´<br><span class="cat">ç”¢å“èªè­‰/åˆè¦</span></td><td class="prompt"><div class="mono">å°{{BOMç‰ˆæœ¬}}é€²è¡ŒRoHS/REACHå½™æ•´ï¼šåˆ—å‡ºæ¯é¡†{{é—œéµé›¶ä»¶}}ã®è­‰æ˜æ–‡ä»¶ç‹€æ…‹ï¼ˆCoC/æ¸¬è©¦å ±å‘Š/å®£å‘Šæ—¥æœŸ/åˆ°æœŸï¼‰ï¼Œç¼ºæ¼é …è«‹è¼¸å‡ºå°ä¾›æ‡‰å•†ã®ç´¢ä»¶éƒµä»¶æ¨¡æ¿ï¼ˆå«æˆªæ­¢æ—¥ã€éœ€æä¾›ã®æ ¼å¼ã€SCIPå¿…è¦æ¬„ä½ï¼‰ã€‚</div></td></tr>
                  <tr data-cat="ç”¢å“èªè­‰/åˆè¦"><td class="id"></td><td class="task">èƒ½æ•ˆ/ErP/DOE æ¨™ç¤ºä¸€è‡´æ€§æª¢æŸ¥<br><span class="cat">ç”¢å“èªè­‰/åˆè¦</span></td><td class="prompt"><div class="mono">é‡å°{{ç”¢å“å‹è™Ÿ}}ã®{{è¼¸å…¥é›»æº/å¾…æ©ŸåŠŸè€—/æ•ˆç‡æ›²ç·š}}ï¼Œç”¢ç”Ÿ{{EU ErP / US DOE}}ç›¸é—œè¦æ±‚ä¹‹æ¨™ç¤º/æ–‡ä»¶ä¸€è‡´æ€§æ¸…å–®ï¼Œåˆ—å‡ºéœ€æ–¼åŒ…è£/èªªæ˜æ›¸/å®˜ç¶²æ­éœ²ä¹‹é …ç›®èˆ‡ç¼ºæ¼é¢¨éšªã€‚</div></td></tr>
                  <tr data-cat="é›¶ä»¶å·¥ç¨‹/æ‰¿èª"><td class="id"></td><td class="task">ä¾›æ‡‰å•†è®Šæ›´ï¼ˆPCNï¼‰é¢¨éšªè©•ä¼°<br><span class="cat">é›¶ä»¶å·¥ç¨‹/æ‰¿èª</span></td><td class="prompt"><div class="mono">é‡å°ä¾›æ‡‰å•†PCNï¼š{{PCNç·¨è™Ÿ/è®Šæ›´å…§å®¹}}ï¼Œè«‹è¼¸å‡ºé¢¨éšªè©•ä¼°ï¼šå—å½±éŸ¿æ–™è™Ÿ/åŠŸèƒ½å±¤ç´šã€é…æ–¹/è£½ç¨‹/å°ºå¯¸è®Šå‹•åˆ†æã€æ›¿ä»£æ–™ç›¸å®¹æ€§ã€éœ€è¦ã®é©—è­‰è¨ˆç•«ï¼ˆæ¸¬è©¦é …ç›®/æ¨£æœ¬é‡/æ™‚é–“è¡¨ï¼‰ã€åº«å­˜èˆ‡åˆ‡æ›ç¯€é»å»ºè­°ã€è·¨éƒ¨é–€RACIã€‚</div></td></tr>
                  <tr data-cat="é›¶ä»¶å·¥ç¨‹/æ‰¿èª"><td class="id"></td><td class="task">PPAP/FAI æ–‡ä»¶å¯©é–±é‡é»æ¸…å–®<br><span class="cat">é›¶ä»¶å·¥ç¨‹/æ‰¿èª</span></td><td class="prompt"><div class="mono">ç‚º{{ä¾›æ‡‰å•†/æ–™è™Ÿ}}å»ºç«‹PPAP/FAIå¯©é–±æ¸…å–®ï¼šè¨­è¨ˆè¨˜éŒ„ã€å·¥ç¨‹è®Šæ›´ã€DFMEAã€PFMEAã€æ§åˆ¶è¨ˆç•«ã€é‡æ¸¬ç³»çµ±ï¼ˆMSA/GRRï¼‰ã€åˆä»¶æª¢é©—çµæœã€èƒ½åŠ›æŒ‡æ¨™{{Cp/Cpké–¾å€¼}}ã€å¤–è§€/åŒ…è£æ¨£æœ¬ã€‚è¼¸å‡ºåˆæ ¼/ç¼ºå¤±/å¾…è£œæ–‡ä»¶åˆ—è¡¨ã€‚</div></td></tr>
                  <tr data-cat="é›¶ä»¶å·¥ç¨‹/æ‰¿èª"><td class="id"></td><td class="task">ä¾†æ–™æª¢é©—è¨ˆç•«èˆ‡AQLå»ºè­°<br><span class="cat">é›¶ä»¶å·¥ç¨‹/æ‰¿èª</span></td><td class="prompt"><div class="mono">æ ¹æ“š{{æ–™è™Ÿ/å¹´å‡ºè²¨é‡/å“è³ªæ­·å²}}ï¼Œè«‹ç”¢å‡ºIQCæŠ½æ¨£æ–¹æ¡ˆï¼šæª¢é©—é …ç›®ã€æª¢é©—æ–¹æ³•/è¦æ ¼ã€AQLç­‰ç´šã€æŠ½æ¨£æ•¸ã€æ¥å—/æ‹’æ”¶æ•¸ã€åŠ åš´/æ”¾å¯¬æ¢ä»¶ï¼Œä¸¦ç”Ÿæˆæª¢é©—ç´€éŒ„è¡¨æ¨¡æ¿ï¼ˆè¡¨é ­æ¬„ä½ï¼‰ã€‚</div></td></tr>
                  <tr data-cat="é›¶ä»¶å·¥ç¨‹/æ‰¿èª"><td class="id"></td><td class="task">åœ–é¢â†’æª¢é©—ç‰¹æ€§å±•é–‹<br><span class="cat">é›¶ä»¶å·¥ç¨‹/æ‰¿èª</span></td><td class="prompt"><div class="mono">å°‡ä¸‹åˆ—åœ–é¢é‡é»è½‰æ›ç‚ºæª¢é©—ç‰¹æ€§æ¸…å–®ï¼š{{åœ–é¢é‡é»/å…¬å·®/é—œéµå°ºå¯¸/è¡¨é¢è™•ç†}}ã€‚è¼¸å‡ºï¼šç‰¹æ€§ç·¨è™Ÿã€è¦æ ¼/å…¬å·®ã€é‡æ¸¬æ–¹æ³•/æ²»å…·ã€é »ç‡ã€è¨˜éŒ„æ¬„ä½ã€åˆ¤å®šè¦å‰‡ã€é—œéµ/é‡å¤§/ä¸€èˆ¬åˆ†é¡ã€‚</div></td></tr>
                  <tr data-cat="è¨­è¨ˆå“è³ª"><td class="id"></td><td class="task">DFMEA è‰æ¡ˆç”¢ç”Ÿå™¨<br><span class="cat">è¨­è¨ˆå“è³ª</span></td><td class="prompt"><div class="mono">é‡å°{{ç³»çµ±/æ¨¡çµ„/é›¶ä»¶}}ï¼Œä¾æ“šåŠŸèƒ½æ¨¹èˆ‡ä»‹é¢åˆ—å‡ºæ½›åœ¨å¤±æ•ˆæ¨¡å¼ï¼šå¤±æ•ˆå½±éŸ¿ã€å¤±æ•ˆåŸå› ã€ç¾è¡Œé é˜²/åµæ¸¬æ§åˆ¶ã€S/O/Dè©•åˆ†ï¼ˆçµ¦å‡ºè©•åˆ†ç†ç”±ï¼‰ã€RPNæ’åºã€å„ªå…ˆæ”¹å–„å»ºè­°èˆ‡è²¬ä»»äºº/æ™‚ç¨‹ã€‚é™„è¼¸å‡ºCSVæ¬„ä½ã€‚</div></td></tr>
                  <tr data-cat="è¨­è¨ˆå“è³ª"><td class="id"></td><td class="task">è¨­è¨ˆå¯©æŸ¥ï¼ˆDRï¼‰è­°ç¨‹èˆ‡å•é …åŒ…<br><span class="cat">è¨­è¨ˆå“è³ª</span></td><td class="prompt"><div class="mono">ç‚º{{å°ˆæ¡ˆåç¨±/è¨­è¨ˆéšæ®µï¼šDR0/DR1/DR2/PV}}ç”¢ç”Ÿè¨­è¨ˆå¯©æŸ¥è­°ç¨‹èˆ‡å¯©æŸ¥æ¸…å–®ï¼šéœ€æ±‚/é¢¨éšª/ç•Œé¢/å¯è£½é€ æ€§/å¯æ¸¬è©¦æ€§/å®‰è¦/EMC/ç†±/ææ–™/éŸŒé«”/DFX/é‡ç”¢é¢¨éšªã€‚ä¸¦åˆ—å‡ºéœ€æº–å‚™ã®è­‰æ“šèˆ‡é€šéæ¨™æº–ã€‚</div></td></tr>
                  <tr data-cat="è¨­è¨ˆå“è³ª/å¯é åº¦"><td class="id"></td><td class="task">å¯é åº¦é©—è­‰è¨ˆç•«ï¼ˆALT/HALT/HASSï¼‰<br><span class="cat">è¨­è¨ˆå“è³ª/å¯é åº¦</span></td><td class="prompt"><div class="mono">åŸºæ–¼{{ç’°å¢ƒæ¢ä»¶/æ‡‰åŠ›è­œ/ä½¿ç”¨æƒ…å¢ƒ}}ï¼Œç‚º{{ç”¢å“å‹è™Ÿ}}ç”¢ç”Ÿå¯é åº¦é©—è­‰è¨ˆç•«ï¼šç›®æ¨™å£½å‘½/å¤±æ•ˆç‡ã€é—œéµæ©Ÿåˆ¶å‡è¨­ã€åŠ é€Ÿæ¨¡å‹ï¼ˆå¦‚Arrhenius/Peckç­‰ï¼‰é¸æ“‡ç†ç”±ã€æ¸¬è©¦çŸ©é™£ã€æ¨£æœ¬é‡èˆ‡åœæ­¢æº–å‰‡ã€è³‡æ–™åˆ†æèˆ‡åˆ¤å®šè¦å‰‡ã€é¢¨éšªç·©è§£å‹•ä½œã€‚</div></td></tr>
                  <tr data-cat="è¨­è¨ˆå“è³ª"><td class="id"></td><td class="task">é‡ç”¢å‰ DFX é¢¨éšªæ¸…å–®<br><span class="cat">è¨­è¨ˆå“è³ª</span></td><td class="prompt"><div class="mono">ä¾{{BOM/è£½ç¨‹æµç¨‹/å¤¾æ²»å…·/æ¸¬è©¦ç«™/åŒ…è£}}ï¼Œç”¢å‡ºDFXï¼ˆDFM/DFA/DFT/DFR/DFCï¼‰é¢¨éšªæ¸…å–®ï¼šé¢¨éšªæè¿°ã€å½±éŸ¿ï¼ˆæˆæœ¬/è‰¯ç‡/é¢¨éšªç­‰ç´šï¼‰ã€åµæ¸¬æ–¹æ³•ã€æ”¹å–„æ–¹æ¡ˆã€Ownerèˆ‡Due Dateã€‚è«‹ç”¨è¡¨æ ¼è¼¸å‡ºä¸¦æ¨™å‡ºTop 5ã€‚</div></td></tr>
                  <tr data-cat="å®¢æˆ¶å“è³ª/å¯é åº¦"><td class="id"></td><td class="task">8D å ±å‘Šå¿«é€Ÿæˆç¨¿<br><span class="cat">å®¢æˆ¶å“è³ª/å¯é åº¦</span></td><td class="prompt"><div class="mono">æ ¹æ“šå®¢è¨´{{Ticket/å®¢æˆ¶/æ©Ÿç¨®/åºè™Ÿ/ç—‡ç‹€/ä¸è‰¯ç‡/æ™‚é–“ç·š}}ï¼Œç”¢å‡º8Dè‰ç¨¿ï¼šD1åœ˜éšŠã€D2å•é¡Œå®šç¾©ï¼ˆå®šç¾©/ç•Œå®š/é‡åŒ–ï¼‰ã€D3åœå µæªæ–½ã€D4æ ¹å› ï¼ˆ5 Why/Fishbone/è­‰æ“šï¼‰ã€D5ç³¾æ­£æªæ–½ã€D6æœ‰æ•ˆæ€§é©—è­‰ã€D7é é˜²å†ç™¼ã€D8è¡¨æšã€‚é™„ä¸ŠKPIï¼ˆé‡å·¥æˆæœ¬/MTBF/é€€è²¨ç‡ï¼‰ã€‚</div></td></tr>
                  <tr data-cat="å®¢æˆ¶å“è³ª/å¯é åº¦"><td class="id"></td><td class="task">æ ¹å› åˆ†æï¼ˆ5-Whyï¼‹é­šéª¨ï¼‰<br><span class="cat">å®¢æˆ¶å“è³ª/å¯é åº¦</span></td><td class="prompt"><div class="mono">é‡å°{{ç¼ºé™·ç¾è±¡/å†ç¾æ¢ä»¶}}ï¼Œè«‹å»ºç«‹5 Whysèˆ‡é­šéª¨åœ–æ–‡æœ¬ï¼šäºº/æ©Ÿ/æ–™/æ³•/ç’°/æ¸¬å…­å¤§é¡ã€‚æ¯ä¸€æ”¯ç·šæä¾›å¯é©—è­‰ã®è­‰æ“šèˆ‡ä¸‹ä¸€æ­¥å¯¦é©—/æ¨£æœ¬é‡ã€‚è¼¸å‡ºæœ€å¾Œé—œéµå› å­æ¸…å–®èˆ‡é©—è­‰è¨ˆç•«ã€‚</div></td></tr>
                  <tr data-cat="å®¢æˆ¶å“è³ª/å¯é åº¦"><td class="id"></td><td class="task">CAPA æ’°å¯«èˆ‡é©—æ”¶æ¨™æº–ï¼ˆSMARTï¼‰<br><span class="cat">å®¢æˆ¶å“è³ª/å¯é åº¦</span></td><td class="prompt"><div class="mono">è«‹å°‡ä¸‹åˆ—æ”¹å–„å»ºè­°è½‰ç‚ºç¬¦åˆSMARTã®CAPAæ¢ç›®ï¼š{{æ”¹å–„å»ºè­°æ¸…å–®}}ã€‚æ¯æ¢å«ï¼šå…·é«”æè¿°ã€é‡åŒ–æŒ‡æ¨™ã€è²¬ä»»äººã€è³‡æºã€æ™‚é–“è¡¨ã€é¢¨éšªã€é©—æ”¶/å¯©æ ¸æ–¹å¼ã€æ–‡ä»¶æ›´æ–°é»ï¼ˆSOP/æª¢é©—è¦ç¯„/æ²»å…·æ ¡æ­£ï¼‰ã€‚</div></td></tr>
                  <tr data-cat="å®¢æˆ¶å“è³ª/å¯é åº¦"><td class="id"></td><td class="task">å®¢è¨´è‹±æ–‡å›è¦†ï¼ˆå°ˆæ¥­ä¸”å‹å–„ï¼‰<br><span class="cat">å®¢æˆ¶å“è³ª/å¯é åº¦</span></td><td class="prompt"><div class="mono">ä»¥{{å“ç‰Œèªæ°£/æ­£å¼ç¨‹åº¦}}æ’°å¯«çµ¦{{å®¢æˆ¶åç¨±}}ã®è‹±æ–‡å›è¦†ï¼šåŒ…å«æ„Ÿè¬ã€å•é¡Œé‡è¿°èˆ‡åŒç†ã€æš«è¡Œåœå µæªæ–½ã€èª¿æŸ¥è¨ˆç•«ï¼ˆæ™‚ç¨‹/é‡Œç¨‹ç¢‘ï¼‰ã€éœ€å®¢æˆ¶å”åŠ©ã®è³‡è¨Šã€ä¸‹ä¸€æ¬¡æ›´æ–°æ™‚é–“é»ã€‚èªæ°£è¦å°ˆæ¥­ã€æ¸…æ¥šã€å¯è¡Œã€å°Šé‡ã€‚</div></td></tr>
                  <tr data-cat="å®¢æˆ¶å“è³ª/å¯é åº¦"><td class="id"></td><td class="task">RMA/æ•…éšœæ¨£å“åˆ†æå ±å‘Šæ‘˜è¦â†’ç°¡å ±<br><span class="cat">å®¢æˆ¶å“è³ª/å¯é åº¦</span></td><td class="prompt"><div class="mono">å°‡ä»¥ä¸‹RMAå ±å‘Šé‡é»è½‰ç‚ºç°¡å ±å¤§ç¶±ï¼š{{å ±å‘Šæ®µè½/æ•¸æ“šåœ–}}ã€‚è¼¸å‡ºï¼š1é åŸ·è¡Œæ‘˜è¦ï¼ˆé—œéµæ•¸å­—/è¶¨å‹¢ï¼‰ã€æ ¹å› èˆ‡è­‰æ“šã€æ”¹å–„è¨ˆç•«èˆ‡æ™‚é–“è¡¨ã€å°å®¢æˆ¶å½±éŸ¿èˆ‡æ‰¿è«¾ã€é™„éŒ„ï¼ˆæ•¸æ“š/ç…§ç‰‡ï¼‰ã€‚é™åˆ¶ï¼šæ¯é æœ€å¤š5å€‹è¦é»ã€‚</div></td></tr>
                  <tr data-cat="å…±ç”¨/ç®¡ç†"><td class="id"></td><td class="task">å…§å¤–éƒ¨ç¨½æ ¸æª¢æŸ¥è¡¨ï¼ˆISO/å®¢æˆ¶/å®‰è¦ï¼‰<br><span class="cat">å…±ç”¨/ç®¡ç†</span></td><td class="prompt"><div class="mono">ç‚º{{ç¨½æ ¸é¡å‹ï¼šISO 9001/14001/å®¢æˆ¶ç¨½æ ¸/å®‰è¦è¦‹è­‰æ¸¬è©¦}}ç”¢ç”Ÿæª¢æŸ¥è¡¨ï¼šæ¢æ¬¾/è¦æ±‚ã€è­‰æ“šæ–‡ä»¶ã€è¨ªè«‡å°è±¡ã€æŠ½æ¨£å»ºè­°ã€å¸¸è¦‹ç¼ºå¤±èˆ‡é¿å…æŠ€å·§ã€æ˜¯/å¦/ä¸é©ç”¨æ¬„ä½ã€‚é™„é–‹å ´èˆ‡çµæ¡ˆæœƒè­°è©±è¡“è¦é»ã€‚</div></td></tr>
                  <tr data-cat="å…±ç”¨/ç®¡ç†"><td class="id"></td><td class="task">å°ˆæ¡ˆKickoff è­°ç¨‹ï¼‹RACI/é‡Œç¨‹ç¢‘<br><span class="cat">å…±ç”¨/ç®¡ç†</span></td><td class="prompt"><div class="mono">ç‚º{{å°ˆæ¡ˆåç¨±}}å»ºç«‹Kickoffå¤§ç¶±ï¼šç›®æ¨™/æˆåŠŸæŒ‡æ¨™ã€é‡Œç¨‹ç¢‘èˆ‡é—œéµè·¯å¾‘ã€RACIã€é¢¨éšªèˆ‡ç·©è§£ã€æºé€šç¯€å¥ï¼ˆæœƒè­°é »ç‡/å ±å‘Šæ¨¡æ¿ï¼‰ã€æ±ºç­–é–€æª»èˆ‡å‡ç´šæ©Ÿåˆ¶ã€‚è¼¸å‡ºç‚º1é æœƒè­°è­°ç¨‹ï¼‹1é è²¬ä»»çŸ©é™£è¡¨ã€‚</div></td></tr>
                  <tr data-cat="å…±ç”¨/ç®¡ç†"><td class="id"></td><td class="task">SOP æ’°å¯«åŠ©æ‰‹ï¼ˆæµç¨‹åœ–ï¼‹è¡¨å–®ï¼‰<br><span class="cat">å…±ç”¨/ç®¡ç†</span></td><td class="prompt"><div class="mono">è«‹ä¾{{æµç¨‹ä¸»é¡Œ}}ç”¢å‡ºSOPè‰æ¡ˆï¼šç›®çš„/ç¯„åœ/åè©å®šç¾©/è§’è‰²è·è²¬/è¼¸å…¥è¼¸å‡º/æ­¥é©Ÿï¼ˆå«æ±ºç­–é»ï¼‰/è¡¨å–®æ¨£å¼/ç´€éŒ„ä¿å­˜/ç¸¾æ•ˆæŒ‡æ¨™/é¢¨éšªèˆ‡æ§åˆ¶ã€‚æœ€å¾Œè¼¸å‡ºä¸€ä»½BPMNæ–‡å­—ç‰ˆæµç¨‹åœ–ç¯€é»æ¸…å–®ã€‚</div></td></tr>
                  <tr data-cat="å…±ç”¨/ç®¡ç†/è³‡æ–™"><td class="id"></td><td class="task">è³‡æ–™è¡¨æ¸…ç†èˆ‡æ¬„ä½æ¨™æº–åŒ–ï¼ˆCSVï¼‰<br><span class="cat">å…±ç”¨/ç®¡ç†/è³‡æ–™</span></td><td class="prompt"><div class="mono">æ ¹æ“šä¸‹åˆ—CSVæ¬„ä½æ¨£æœ¬ï¼Œç”¢ç”Ÿæ¸…ç†æ­¥é©Ÿï¼š{{æ¬„ä½èˆ‡ç¯„ä¾‹}}ã€‚åŒ…å«ï¼šæ¬„ä½é‡å‘½åè¦ç¯„ã€å–®ä½çµ±ä¸€ã€ç¼ºå¤±å€¼è™•ç†ã€è¦å‰‡æª¢æ ¸ï¼ˆå¦‚åºè™Ÿ/æ—¥æœŸ/ç‰ˆæœ¬ï¼‰ã€è¡çªåˆä½µç­–ç•¥ã€è¼¸å‡ºæ¬„ä½é †åºèˆ‡è³‡æ–™å­—å…¸ã€‚</div></td></tr>
                  <tr data-cat="å…±ç”¨/ç®¡ç†"><td class="id"></td><td class="task">æç¤ºè©å„ªåŒ–å™¨ï¼ˆæŠŠéœ€æ±‚â†’å¯åŸ·è¡ŒPromptï¼‰<br><span class="cat">å…±ç”¨/ç®¡ç†</span></td><td class="prompt"><div class="mono">è«‹å°‡ä»¥ä¸‹éœ€æ±‚è½‰ç‚ºé«˜å“è³ªPromptï¼š{{åŸå§‹éœ€æ±‚æ•˜è¿°}}ã€‚åŸå‰‡ï¼š1) æŒ‡å®šè§’è‰²èˆ‡ç”¢å‡ºæ ¼å¼ï¼›2) åˆ—å‡ºè¼¸å…¥è®Šæ•¸ï¼›3) åŠ å…¥æˆåŠŸæ¢ä»¶/é™åˆ¶ï¼›4) è¦æ±‚é€æ­¥æ¨ç†èˆ‡æ ¸å°æ¸…å–®ï¼›5) åŠ å…¥é©—æ”¶æ¨™æº–èˆ‡ç¯„ä¾‹ã€‚</div></td></tr>
                  <tr data-cat="å…±ç”¨/ç®¡ç†"><td class="id"></td><td class="task">ä¸­è‹±æŠ€è¡“ç¿»è­¯ï¼‹åœ¨åœ°åŒ–è¡“èª<br><span class="cat">å…±ç”¨/ç®¡ç†</span></td><td class="prompt"><div class="mono">å°‡ä»¥ä¸‹æŠ€è¡“å…§å®¹æ–¼{{ç›®æ¨™åœ°å€èªè¨€ç¿’æ…£ï¼šUS/UK/EU/CN/TW}}åœ¨åœ°åŒ–ç¿»è­¯ï¼Œä¿ç•™æ•¸æ“šèˆ‡é‡è©ä¸è®Šã€‚è«‹è¼¸å‡ºå°ç…§è¡¨ï¼šåŸæ–‡ã€è­¯æ–‡ã€å°ˆæ¥­è¡“èªèªªæ˜ã€å¯èƒ½ã®èª¤è­¯é¢¨éšªèˆ‡é¿å…å»ºè­°ã€‚</div></td></tr>
                  <tr data-cat="ç”¢å“èªè­‰/åˆè¦"><td class="id"></td><td class="task">æ–°èˆŠæ³•è¦å·®ç•°åˆ†æ<br><span class="cat">ç”¢å“èªè­‰/åˆè¦</span></td><td class="prompt"><div class="mono">ä½œç‚ºä¸€åç¶“é©—è±å¯Œçš„ç”¢å“åˆè¦å°ˆå®¶ï¼Œè«‹æ¯”è¼ƒ {{æ–°ç‰ˆæ³•è¦ï¼Œä¾‹å¦‚ EN 62368-1:2020}} èˆ‡ {{èˆŠç‰ˆæ³•è¦ï¼Œä¾‹å¦‚ EN 60950-1}} çš„ä¸»è¦å·®ç•°ã€‚è«‹ä»¥è¡¨æ ¼å½¢å¼å‘ˆç¾ï¼Œæ¬„ä½åŒ…å«ï¼šã€Œæ¢æ¬¾ç« ç¯€ã€ã€ã€ŒèˆŠç‰ˆè¦æ±‚æ‘˜è¦ã€ã€ã€Œæ–°ç‰ˆè¦æ±‚æ‘˜è¦ã€ã€ä»¥åŠã€Œå°æˆ‘å€‘ {{ç”¢å“é¡å‹ï¼Œä¾‹å¦‚äº¤æ›å¼é›»æºä¾›æ‡‰å™¨}} è¨­è¨ˆçš„æ½›åœ¨å½±éŸ¿ã€ã€‚æœ€å¾Œï¼Œç¸½çµå‡º 3 å€‹æœ€é«˜é¢¨éšªçš„æ”¹å‹•é»ã€‚</div></td></tr>
                  <tr data-cat="ç”¢å“èªè­‰/åˆè¦"><td class="id"></td><td class="task">æ¸¬è©¦è¨ˆç•«è‰æ¡ˆç”Ÿæˆ<br><span class="cat">ç”¢å“èªè­‰/åˆè¦</span></td><td class="prompt"><div class="mono">æˆ‘éœ€è¦ç‚ºç”¢å“ {{ç”¢å“å‹è™Ÿ}} å»ºç«‹ä¸€ä»½é‡å° {{å…·é«”æ¨™æº–ï¼Œä¾‹å¦‚ EN 55032 Class B}} çš„é›»ç£ç›¸å®¹æ€§ (EMC) æ¸¬è©¦è¨ˆç•«è‰æ¡ˆã€‚è«‹åŸºæ–¼æ­¤æ¨™æº–ï¼Œåˆ—å‡ºæ‰€æœ‰å¿…è¦çš„æ¸¬è©¦é …ç›®ï¼ˆä¾‹å¦‚ï¼šè¼»å°„é¨·æ“¾ã€å‚³å°é¨·æ“¾ï¼‰ï¼Œä¸¦ç‚ºæ¯å€‹é …ç›®æä¾›ï¼š1) æ¸¬è©¦ç›®çš„ï¼Œ2) æ¸¬è©¦é…ç½®èˆ‡é »ç‡ç¯„åœï¼Œ3) åˆæ ¼çš„é™å€¼è¦æ±‚ (Limit)ï¼Œ4) éœ€è¦æº–å‚™çš„æ¨£å“èˆ‡è¼”åŠ©è¨­å‚™æ¸…å–®ã€‚</div></td></tr>
                  <tr data-cat="ç”¢å“èªè­‰/åˆè¦"><td class="id"></td><td class="task">ç¬¦åˆæ€§è²æ˜ (DoC) æ–‡ä»¶è‰æ“¬<br><span class="cat">ç”¢å“èªè­‰/åˆè¦</span></td><td class="prompt"><div class="mono">è«‹å¹«æˆ‘è‰æ“¬ä¸€ä»½é©ç”¨æ–¼ {{ç›®æ¨™å¸‚å ´ï¼Œä¾‹å¦‚æ­ç›Ÿ}} çš„ç¬¦åˆæ€§è²æ˜ (Declaration of Conformity) æ–‡ä»¶æ¨¡æ¿ã€‚å…§å®¹éœ€åŒ…å«ï¼š1) ç”¢å“è³‡è¨Š (å‹è™Ÿ/åç¨±)ï¼Œ2) è£½é€ å•†è³‡è¨Šï¼Œ3) è²æ˜æ­¤ç”¢å“ç¬¦åˆçš„æŒ‡ä»¤ (ä¾‹å¦‚ï¼šEMC æŒ‡ä»¤ 2014/30/EU, RoHS æŒ‡ä»¤ 2011/65/EU)ï¼Œ4) å¼•ç”¨çš„ä¸€è‡´æ€§æ¨™æº–æ¸…å–®ï¼Œ5) ç°½ç½²è³‡è¨Šæ¬„ä½ã€‚è«‹ä½¿ç”¨å°ˆæ¥­ä¸”æ­£å¼çš„ {{ç›®æ¨™èªè¨€ï¼Œä¾‹å¦‚è‹±æ–‡}} æ’°å¯«ã€‚</div></td></tr>
                  <tr data-cat="é›¶ä»¶å·¥ç¨‹/æ‰¿èª"><td class="id"></td><td class="task">é›¶ä»¶æ‰¿èªæ¸¬è©¦è¨ˆç•«<br><span class="cat">é›¶ä»¶å·¥ç¨‹/æ‰¿èª</span></td><td class="prompt"><div class="mono">æˆ‘æ­£åœ¨è©•ä¼°ä¸€é¡†æ–°çš„ {{é›¶ä»¶é¡å‹ï¼Œä¾‹å¦‚ MOSFET}}ï¼Œæ–™è™Ÿæ˜¯ {{é›¶ä»¶æ–™è™Ÿ}}ï¼Œé è¨ˆç”¨æ–¼ {{æ‡‰ç”¨å ´æ™¯ï¼Œä¾‹å¦‚é«˜åŠŸç‡å¯†åº¦çš„ä¼ºæœå™¨é›»æº}}ã€‚è«‹ç‚ºæˆ‘ç”¢ç”Ÿä¸€ä»½é›¶ä»¶æ‰¿èªæ¸¬è©¦è¨ˆç•« (Component Qualification Plan)ã€‚è¨ˆç•«æ‡‰åŒ…å«ï¼š1) é›»æ€§åƒæ•¸é©—è­‰ (åƒè€ƒ Datasheet)ï¼Œ2) å¯é åº¦æ¸¬è©¦ (ä¾‹å¦‚ï¼šHTOL, TC)ï¼Œ3) æ¿éšå¯é åº¦æ¸¬è©¦ (BLR)ï¼Œ4) ç ´å£æ€§ç‰©ç†åˆ†æ (DPA) æª¢æŸ¥é»ã€‚è«‹å»ºè­°æ¯å€‹æ¸¬è©¦é …ç›®çš„æ¨£æœ¬æ•¸èˆ‡å…æ”¶æ¨™æº–ã€‚</div></td></tr>
                  <tr data-cat="é›¶ä»¶å·¥ç¨‹/æ‰¿èª"><td class="id"></td><td class="task">ä¾›æ‡‰å•†æŠ€è¡“å•é¡Œæºé€šéƒµä»¶<br><span class="cat">é›¶ä»¶å·¥ç¨‹/æ‰¿èª</span></td><td class="prompt"><div class="mono">è«‹ä»¥å°ˆæ¥­çš„å“ä¿å·¥ç¨‹å¸«èªæ°£ï¼Œè‰æ“¬ä¸€å°çµ¦ä¾›æ‡‰å•†çš„è‹±æ–‡éƒµä»¶ã€‚äº‹ç”±ï¼šé‡å° {{é›¶ä»¶æ–™è™Ÿ}} çš„ {{æŠ€è¡“å•é¡Œï¼Œä¾‹å¦‚ Datasheet ä¸­é—œæ–¼ derating curve çš„å®šç¾©ä¸æ˜ç¢º}} æå‡ºæŠ€è¡“ç–‘å•ã€‚éƒµä»¶å…§å®¹éœ€åŒ…å«ï¼š1) æ¸…æ™°æè¿°æˆ‘å€‘é‡åˆ°çš„å•é¡Œï¼Œ2) é™„ä¸Šæˆ‘å€‘ç›®å‰çš„ç†è§£æˆ–æ¸¬è©¦æ•¸æ“šï¼Œ3) æå‡ºå…·é«”çš„æ¾„æ¸…è«‹æ±‚ (ä¾‹å¦‚ï¼šè«‹æä¾›åœ¨ 85Â°C ç’°å¢ƒæº«åº¦ä¸‹çš„å»ºè­°æ“ä½œé›»æµ)ã€‚</div></td></tr>
                  <tr data-cat="è¨­è¨ˆå“è³ª"><td class="id"></td><td class="task">DFM (å¯è£½é€ æ€§è¨­è¨ˆ) å¯©æŸ¥æ¸…å–®<br><span class="cat">è¨­è¨ˆå“è³ª</span></td><td class="prompt"><div class="mono">é‡å°ä¸€å€‹ {{ç”¢å“é¡å‹ï¼Œä¾‹å¦‚å·¥æ¥­é›»è…¦ä¸»æ©Ÿæ¿}} çš„ PCB Layout è¨­è¨ˆï¼Œè«‹ç”Ÿæˆä¸€ä»½è£½é€ æ€§è¨­è¨ˆ (DFM) çš„å¯©æŸ¥æ¸…å–®ã€‚æ¸…å–®éœ€æ¶µè“‹ä»¥ä¸‹æ–¹é¢ï¼š1) PCB ç–Šæ§‹èˆ‡ææ–™ï¼Œ2) é›¶ä»¶é–“è·èˆ‡ä½ˆå±€ï¼Œ3) èµ°ç·šè¦å‰‡ï¼Œ4) çµ²å°èˆ‡æ¨™ç¤ºï¼Œ5) Vias and Pads è¨­è¨ˆï¼Œ6) å¯æ¸¬è©¦æ€§è¨­è¨ˆ (DFT)ã€‚è«‹å°‡é‡é»æ”¾åœ¨é¿å…å¸¸è¦‹çš„ç”Ÿç”¢å•é¡Œã€‚</div></td></tr>
                  <tr data-cat="è¨­è¨ˆå“è³ª"><td class="id"></td><td class="task">DFMEA å¤±æ•ˆæ¨¡å¼è…¦åŠ›æ¿€ç›ª<br><span class="cat">è¨­è¨ˆå“è³ª</span></td><td class="prompt"><div class="mono">æˆ‘æ­£åœ¨ç‚º {{ç”¢å“çš„ä¸€å€‹æ¨¡çµ„ï¼Œä¾‹å¦‚é›»æ± å……é›»è¿´è·¯}} é€²è¡Œ DFMEA åˆ†æã€‚æ­¤è¿´è·¯çš„ä¸»è¦åŠŸèƒ½æ˜¯ {{åŠŸèƒ½æè¿°ï¼Œä¾‹å¦‚ä½¿ç”¨ BQ25700A æ™¶ç‰‡ç‚º 4 ä¸²é‹°é›»æ± å……é›»}}ã€‚è«‹å¹«æˆ‘è…¦åŠ›æ¿€ç›ªå‡ºè‡³å°‘ 10 å€‹æ½›åœ¨çš„å¤±æ•ˆæ¨¡å¼ (Failure Modes)ã€‚å°æ–¼æ¯å€‹å¤±æ•ˆæ¨¡å¼ï¼Œè«‹æ¨æ¸¬å…¶å¯èƒ½çš„å¤±æ•ˆå½±éŸ¿ (Effects) å’Œæ½›åœ¨çš„å¤±æ•ˆåŸå›  (Causes)ã€‚ä»¥è¡¨æ ¼å½¢å¼å‘ˆç¾ã€‚</div></td></tr>
                  <tr data-cat="å®¢æˆ¶å“è³ª/å¯é åº¦"><td class="id"></td><td class="task">å®¢é€€å“æ•¸æ“šåˆæ­¥åˆ†æ<br><span class="cat">å®¢æˆ¶å“è³ª/å¯é åº¦</span></td><td class="prompt"><div class="mono">ä½ æ˜¯ä¸€ä½è³‡æ·±çš„å¯é åº¦å·¥ç¨‹å¸«ã€‚æˆ‘é€™è£¡æœ‰ä¸€æ‰¹ç¾å ´å®¢é€€å“çš„æ•¸æ“šï¼š{{è«‹è²¼ä¸Šå»è­˜åˆ¥åŒ–çš„æ•¸æ“šï¼Œä¾‹å¦‚ï¼šç”¢å“å‹è™Ÿ Aï¼Œç¸½å‡ºè²¨é‡ 10,000 å°ï¼Œ1 å¹´å…§å®¢é€€ 50 å°ï¼Œæ•…éšœç¾è±¡é›†ä¸­åœ¨é–‹æ©Ÿç„¡é¡¯ç¤º (35å°) å’Œç¶²è·¯æ–·ç·š (15å°)}}ã€‚è«‹å¹«æˆ‘åˆ†æé€™äº›æ•¸æ“šï¼š1) è¨ˆç®—åˆæ­¥çš„å¹´åŒ–å¤±æ•ˆç‡ (AFR) å’Œ MTBFã€‚2) æ ¹æ“šæ•…éšœç¾è±¡çš„å¸•ç´¯æ‰˜åˆ†ä½ˆ (Pareto)ï¼ŒæŒ‡å‡ºæ‡‰å„ªå…ˆåˆ†æçš„é …ç›®ã€‚3) å»ºè­°æ¥ä¸‹ä¾†çš„åˆ†ææ­¥é©Ÿã€‚</div></td></tr>
                  <tr data-cat="å®¢æˆ¶å“è³ª/å¯é åº¦"><td class="id"></td><td class="task">8D å ±å‘Šå…§å®¹å„ªåŒ–<br><span class="cat">å®¢æˆ¶å“è³ª/å¯é åº¦</span></td><td class="prompt"><div class="mono">è«‹å¹«æˆ‘å„ªåŒ–ä»¥ä¸‹é€™æ®µ 8D å ±å‘Šä¸­çš„ D4 (æ ¹æœ¬åŸå› åˆ†æ) å…§å®¹ã€‚ç›®æ¨™æ˜¯ä½¿å…¶èªæ°£æ›´å°ˆæ¥­ã€é‚è¼¯æ›´æ¸…æ™°ã€‚è«‹æª¢æŸ¥æ˜¯å¦æœ‰ä»»ä½•é‚è¼¯è·³èºæˆ–è­‰æ“šä¸è¶³ä¹‹è™•ï¼Œä¸¦æå‡ºæ”¹å¯«å»ºè­°èˆ‡ç†ç”±ã€‚åŸæ–‡å¦‚ä¸‹ï¼š{{è²¼ä¸Š D4 è‰ç¨¿å…§å®¹}}</div></td></tr>
                  <tr data-cat="å…±ç”¨/ç®¡ç†"><td class="id"></td><td class="task">ç®¡ç†å±¤å ±å‘Šæ‘˜è¦ (Executive Summary)<br><span class="cat">å…±ç”¨/ç®¡ç†</span></td><td class="prompt"><div class="mono">è«‹å°‡ä»¥ä¸‹é€™ä»½ {{å ±å‘Šé¡å‹ï¼Œä¾‹å¦‚ QBR å“è³ªå ±å‘Š}} çš„é‡é»å…§å®¹ï¼Œæ¿ƒç¸®æˆä¸€ä»½ä¸è¶…é 250 å­—çš„æ‘˜è¦ï¼Œé©åˆå‘é«˜éšä¸»ç®¡åŒ¯å ±ã€‚æ‘˜è¦éœ€åŒ…å«ï¼š1) æ•´é«”å“è³ªè¡¨ç¾ (KPIs)ï¼Œ2) æœ¬å­£åº¦çš„ä¸»è¦å“è³ªå•é¡Œèˆ‡æ”¹é€²æˆæœï¼Œ3) é¢è‡¨çš„æŒ‘æˆ°èˆ‡é¢¨éšªï¼Œ4) ä¸‹ä¸€æ­¥çš„è¡Œå‹•è¨ˆç•«ã€‚å ±å‘ŠåŸæ–‡é‡é»å¦‚ä¸‹ï¼š{{è²¼ä¸Šå»è­˜åˆ¥åŒ–çš„å ±å‘Šé‡é»æ®µè½}}</div></td></tr>
                  <tr data-cat="å…±ç”¨/ç®¡ç†"><td class="id"></td><td class="task">å…§éƒ¨è¨“ç·´èª²ç¨‹å¤§ç¶±è¦åŠƒ<br><span class="cat">å…±ç”¨/ç®¡ç†</span></td><td class="prompt"><div class="mono">æˆ‘éœ€è¦ç‚ºæ–°é€²çš„å“è³ªå·¥ç¨‹å¸«è¨­è¨ˆä¸€ä»½é—œæ–¼ã€Œæ ¹æœ¬åŸå› åˆ†æ (Root Cause Analysis)ã€çš„æ•™è‚²è¨“ç·´ã€‚è«‹å¹«æˆ‘è¦åŠƒä¸€ä»½ 1 å°æ™‚çš„èª²ç¨‹å¤§ç¶±ï¼ŒåŒ…å«ï¼š1) å­¸ç¿’ç›®æ¨™ï¼Œ2) å„å–®å…ƒä¸»é¡Œ (ä¾‹å¦‚ï¼šä»€éº¼æ˜¯ RCAã€5 Whys æ–¹æ³•ã€é­šéª¨åœ–)ï¼Œ3) æ¯å€‹å–®å…ƒçš„æ™‚é–“åˆ†é…ï¼Œ4) äº’å‹•ç·´ç¿’æˆ–æ¡ˆä¾‹ç ”è¨çš„å»ºè­°ã€‚</div></td></tr>
                </tbody>
                <tbody id="prompt-list"></tbody>
              </table>
            </div>
        </section>
        <p class="footer">Â© 2025 å“è³ªè™• Prompt Library â€“ é›²ç«¯å”ä½œç‰ˆ</p>
    </div>
  </div>

  <div class="modal-overlay" id="promptModal"><div class="modal-container"><div class="modal-header"><h3 id="modalTitle"></h3><button class="close-btn">&times;</button></div><div class="modal-content"><form id="promptForm"><input type="hidden" id="promptId"><div class="form-group"><label for="taskInput">ä»»å‹™ç›®æ¨™</label><input type="text" id="taskInput" required></div><div class="form-group"><label for="categoryInput">åˆ†é¡</label><select id="categoryInput" required></select></div><div class="form-group"><label for="promptInput">Prompt è©</label><textarea id="promptInput" rows="10" required></textarea></div><div class="form-group"><label for="authorInput">å»ºç«‹è€… / ä¿®æ”¹è€…</label><input type="text" id="authorInput" required></div><div class="modal-footer"><select id="historySelect" class="small history-select" disabled></select><button type="button" class="btn" id="saveBtn">å„²å­˜</button></div></form></div></div></div>
  <div class="modal-overlay" id="categoryModal"><div class="modal-container" style="max-width: 500px;"><div class="modal-header"><h3 id="categoryModalTitle">ç®¡ç†åˆ†é¡</h3><button class="close-btn">&times;</button></div><div class="modal-content"><ul id="categoryList"></ul><form id="newCategoryForm"><input type="text" id="newCategoryInput" placeholder="è¼¸å…¥æ–°åˆ†é¡åç¨±..." required><button type="submit" class="btn btn-action small">æ–°å¢</button></form></div><div class="modal-footer"><button class="btn ghost" id="closeCategoryModalBtn">å®Œæˆ</button></div></div></div>
  <div id="toastContainer" class="toast-container"></div>
  <template id="prompt-row-template"><tr class="prompt-row"><td class="id"></td><td><div class="task"></div><div class="meta-container"><span class="chip clickable category-label"></span><span class="meta-item copy-count"></span><span class="meta-item author"></span><span class="meta-item last-modified"></span></div></td><td class="prompt"><div class="mono"></div></td><td class="row-tools"><button class="btn small ghost copy">è¤‡è£½</button><button class="btn small btn-action edit">ç·¨è¼¯</button><button class="btn small btn-danger delete">åˆªé™¤</button></td></tr></template>
  
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>

  <script>
    class PromptLibraryApp {
      constructor() {
        this.elements = {
            tableBody: document.getElementById('prompt-list'), initialDataSource: document.getElementById('initial-data'),
            searchInput: document.getElementById('search'), clearSearchBtn: document.getElementById('clearSearchBtn'), categoryFilter: document.getElementById('categoryFilter'),
            categoryChipsContainer: document.getElementById('categoryChipsContainer'),
            addNewBtn: document.getElementById('addNew'), manageCategoriesBtn: document.getElementById('manageCategoriesBtn'), exportBtn: document.getElementById('exportBtn'), importBtn: document.getElementById('importBtn'), fileImporter: document.getElementById('fileImporter'),
            importErrorContainer: document.getElementById('importErrorContainer'), manualImportLink: document.getElementById('manualImportLink'),
            promptModal: { self: document.getElementById('promptModal'), title: document.getElementById('modalTitle'), form: document.getElementById('promptForm'), idInput: document.getElementById('promptId'), taskInput: document.getElementById('taskInput'), categoryInput: document.getElementById('categoryInput'), promptInput: document.getElementById('promptInput'), authorInput: document.getElementById('authorInput'), historySelect: document.getElementById('historySelect'), saveBtn: document.getElementById('saveBtn'), },
            categoryModal: { self: document.getElementById('categoryModal'), list: document.getElementById('categoryList'), form: document.getElementById('newCategoryForm'), input: document.getElementById('newCategoryInput'), closeBtn: document.getElementById('closeCategoryModalBtn'), },
            manualImportModal: { self: document.getElementById('manualImportModal'), textArea: document.getElementById('manualImportText'), importBtn: document.getElementById('importFromTextBtn') },
            rowTemplate: document.getElementById('prompt-row-template'),
        };
        this.prompts = []; this.categories = []; this.isContentDirty = false;
        this.activeCategories = [];
        this.db = null;
      }

      init() {
        this._initFirebase();
        this._setupRealtimeListeners();
        this._bindEventListeners();
      }

      _initFirebase() {
        const firebaseConfig = {
            apiKey: "AIzaSyDQDorsdx2Cetyp46riQC7i_xB2dMCvuYc",
            authDomain: "qmd-prompt-library.firebaseapp.com",
            projectId: "qmd-prompt-library",
            storageBucket: "qmd-prompt-library.firebasestorage.app",
            messagingSenderId: "622746077507",
            appId: "1:622746077507:web:e5a1089f93dbf4dd5807f6",
            measurementId: "G-KHGRGT7W30"
        };
        try { firebase.initializeApp(firebaseConfig); this.db = firebase.firestore(); } 
        catch (e) { console.error("Firebase åˆå§‹åŒ–å¤±æ•—:", e); alert("é›²ç«¯è³‡æ–™åº«åˆå§‹åŒ–å¤±æ•—ï¼è«‹æª¢æŸ¥æ‚¨çš„ Firebase è¨­å®šã€‚"); }
      }

      _setupRealtimeListeners() {
        if (!this.db) return;
        this.db.collection("categories").orderBy("name").onSnapshot(snapshot => {
            this.categories = snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));
            this._populateCategoryDropdowns(); this._renderCategoryChips(); this._renderTable();
        });
        this.db.collection("prompts").orderBy("createdDate", "desc").onSnapshot(snapshot => {
            if (snapshot.empty && this.categories.length === 0) { this._seedDataToFirestore(); } 
            else { this.prompts = snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() })); this._renderTable(); }
        });
      }

      async _seedDataToFirestore() {
        console.log("è³‡æ–™åº«æ˜¯ç©ºçš„ï¼Œæ­£åœ¨å¾ HTML æ¤å…¥åˆå§‹è³‡æ–™åˆ°é›²ç«¯...");
        if (!this.db) return;
        const rows = this.elements.initialDataSource.querySelectorAll('tr'); const categories = new Set();
        const promptsToSeed = [];
        rows.forEach(row => {
            const categoryText = row.querySelector('.cat').innerText.trim();
            const taskCell = row.querySelector('.task'); const taskText = taskCell.childNodes[0].nodeValue.trim();
            categories.add(categoryText);
            promptsToSeed.push({
                task: taskText, category: categoryText, prompt: row.querySelector('.prompt .mono').innerText.trim(),
                author: 'System', createdDate: new Date(), lastModified: new Date(), copyCount: 0, history: []
            });
        });
        const batch = this.db.batch();
        [...categories].sort().forEach(catName => {
            const catRef = this.db.collection("categories").doc();
            batch.set(catRef, { name: catName });
        });
        promptsToSeed.forEach(prompt => {
            const promptRef = this.db.collection("prompts").doc();
            batch.set(promptRef, prompt);
        });
        try { await batch.commit(); this._showToast("å·²æˆåŠŸå°‡é è¨­æç¤ºè©åº«ä¸Šå‚³è‡³é›²ç«¯ï¼"); } 
        catch (e) { console.error("æ¤å…¥åˆå§‹è³‡æ–™å¤±æ•—:", e); }
      }

      _renderTable() {
        const { tableBody, searchInput } = this.elements; tableBody.innerHTML = '';
        const searchTerm = searchInput.value.trim().toLowerCase();
        const filtered = this.prompts.filter(p => {
            const matchesCategory = this.activeCategories.length === 0 || this.activeCategories.includes(p.category);
            const matchesSearch = !searchTerm || p.task.toLowerCase().includes(searchTerm) || p.prompt.toLowerCase().includes(searchTerm);
            return matchesCategory && matchesSearch;
        });
        if (filtered.length === 0) { tableBody.innerHTML = `<tr><td colspan="4" style="text-align: center; padding: 32px;">æ‰¾ä¸åˆ°ç¬¦åˆæ¢ä»¶çš„æç¤ºè©ã€‚</td></tr>`; return; }

        filtered.forEach((prompt, index) => {
            const row = this.elements.rowTemplate.content.cloneNode(true);
            const tr = row.querySelector('.prompt-row'); tr.dataset.id = prompt.id;
            row.querySelector('.id').textContent = index + 1;
            row.querySelector('.task').textContent = prompt.task;
            const categoryLabel = row.querySelector('.category-label');
            categoryLabel.textContent = prompt.category; categoryLabel.dataset.category = prompt.category;
            row.querySelector('.prompt .mono').innerHTML = prompt.prompt.replace(/\n/g, '<br>');
            row.querySelector('.copy-count').textContent = `è¤‡è£½ ${prompt.copyCount} æ¬¡`;
            row.querySelector('.author').textContent = `ä½œè€…: ${prompt.author || 'N/A'}`;
            const lastModifiedDate = prompt.lastModified && prompt.lastModified.toDate ? prompt.lastModified.toDate() : new Date();
            row.querySelector('.last-modified').textContent = `æ›´æ–°: ${lastModifiedDate.toLocaleDateString()}`;
            tableBody.appendChild(row);
        });
        this._updateActiveFilters();
      }
      
      _populateCategoryDropdowns() {
        const { categoryFilter, promptModal } = this.elements;
        const { categoryInput } = promptModal;
        const currentFilterValue = categoryFilter.value;
        categoryFilter.innerHTML = '<option value="all">å…¨éƒ¨åˆ†é¡</option>';
        this.categories.forEach(cat => { categoryFilter.innerHTML += `<option value="${cat.name}">${cat.name}</option>`; });
        if(this.categories.some(c => c.name === currentFilterValue)) { categoryFilter.value = currentFilterValue; }
        const currentModalValue = categoryInput.value;
        categoryInput.innerHTML = '';
        this.categories.forEach(cat => { categoryInput.innerHTML += `<option value="${cat.name}">${cat.name}</option>`; });
        if(this.categories.some(c => c.name === currentModalValue)) { categoryInput.value = currentModalValue; }
      }

      _renderCategoryChips() {
          const { categoryChipsContainer } = this.elements;
          categoryChipsContainer.innerHTML = '';
          const allChip = document.createElement('span');
          allChip.className = 'chip clickable'; allChip.textContent = 'å…¨éƒ¨åˆ†é¡'; allChip.dataset.category = 'all';
          categoryChipsContainer.appendChild(allChip);
          this.categories.forEach(cat => {
              const chip = document.createElement('span');
              chip.className = 'chip clickable'; chip.textContent = cat.name; chip.dataset.category = cat.name;
              categoryChipsContainer.appendChild(chip);
          });
          this._updateActiveFilters();
      }

      _updateActiveFilters() {
          const { categoryFilter, categoryChipsContainer } = this.elements;
          categoryChipsContainer.querySelectorAll('.chip').forEach(chip => {
              const category = chip.dataset.category;
              const isActive = (this.activeCategories.length === 0 && category === 'all') || this.activeCategories.includes(category);
              chip.classList.toggle('active', isActive);
          });
          if (this.activeCategories.length === 1) { categoryFilter.value = this.activeCategories[0]; } 
          else { categoryFilter.value = 'all'; }
      }

      _renderCategoryList() {
        const { list } = this.elements.categoryModal; list.innerHTML = '';
        this.categories.forEach(cat => {
            const isUsed = this.prompts.some(p => p.category === cat.name);
            list.innerHTML += `<li><span>${cat.name}</span><button class="btn small btn-danger" data-id="${cat.id}" ${isUsed ? 'disabled title="åˆ†é¡ä½¿ç”¨ä¸­ï¼Œç„¡æ³•åˆªé™¤"' : ''}>åˆªé™¤</button></li>`;
        });
      }

      _openModal(modalElement) { modalElement.classList.add('active'); }
      _closeModal(modalElement) { modalElement.classList.remove('active'); }

      _bindEventListeners() {
        const { searchInput, clearSearchBtn, categoryFilter, addNewBtn, manageCategoriesBtn, exportBtn, importBtn, fileImporter, categoryChipsContainer, manualImportLink } = this.elements;
        const { self: promptModal, saveBtn } = this.elements.promptModal;
        const { self: categoryModal, form: categoryForm, list: categoryList, closeBtn: closeCategoryModalBtn } = this.elements.categoryModal;
        const { self: manualImportModal, importBtn: importFromTextBtn } = this.elements.manualImportModal;

        searchInput.addEventListener('input', () => { this._toggleClearSearchBtn(); this._renderTable(); });
        clearSearchBtn.addEventListener('click', () => { searchInput.value = ''; searchInput.focus(); this._toggleClearSearchBtn(); this._renderTable(); });
        categoryFilter.addEventListener('change', (e) => {
            this.activeCategories = e.target.value === 'all' ? [] : [e.target.value];
            this._updateActiveFilters(); this._renderTable();
        });
        categoryChipsContainer.addEventListener('click', e => {
            const target = e.target;
            if (target.classList.contains('chip')) {
                const category = target.dataset.category;
                if (category === 'all') { this.activeCategories = []; } 
                else {
                    const index = this.activeCategories.indexOf(category);
                    if (index > -1) { this.activeCategories.splice(index, 1); } 
                    else { this.activeCategories.push(category); }
                }
                this._updateActiveFilters(); this._renderTable();
            }
        });
        addNewBtn.addEventListener('click', () => this._openPromptModal('add'));
        manageCategoriesBtn.addEventListener('click', () => { this._renderCategoryList(); this._openModal(categoryModal); });
        exportBtn.addEventListener('click', () => this._exportData());
        importBtn.addEventListener('click', () => fileImporter.click());
        fileImporter.addEventListener('change', e => this._handleFileImport(e));
        manualImportLink.addEventListener('click', e => { e.preventDefault(); this._openModal(manualImportModal); });
        this.elements.tableBody.addEventListener('click', e => this._handleTableClick(e));
        promptModal.addEventListener('click', e => { if (e.target === promptModal || e.target.classList.contains('close-btn')) this._closePromptModal(); });
        this.elements.promptModal.form.addEventListener('input', () => { this.isContentDirty = true; });
        saveBtn.addEventListener('click', () => this._savePrompt());
        this.elements.promptModal.historySelect.addEventListener('change', (e) => this._restoreHistory(e));
        categoryModal.addEventListener('click', e => { if (e.target === categoryModal || e.target.classList.contains('close-btn') || e.target === closeCategoryModalBtn) this._closeModal(categoryModal); });
        categoryForm.addEventListener('submit', e => { e.preventDefault(); this._addNewCategory(); });
        categoryList.addEventListener('click', e => { if (e.target.tagName === 'BUTTON') this._deleteCategory(e.target.dataset.id); });
        manualImportModal.addEventListener('click', e => { if (e.target === manualImportModal || e.target.classList.contains('close-btn')) this._closeModal(manualImportModal); });
        importFromTextBtn.addEventListener('click', () => this._handleManualImport());
        document.addEventListener('keydown', e => { if (e.key === 'Escape' && (promptModal.classList.contains('active') || categoryModal.classList.contains('active') || manualImportModal.classList.contains('active'))) { this._closeModal(promptModal); this._closeModal(categoryModal); this._closeModal(manualImportModal); } });
        window.addEventListener('beforeunload', e => { if (this.isContentDirty) { e.preventDefault(); e.returnValue = ''; } });
      }

      _handleTableClick(e) {
          const row = e.target.closest('.prompt-row'); if (!row) return;
          const id = row.dataset.id;
          if (e.target.closest('.copy')) {
              const prompt = this.prompts.find(p => p.id === id);
              if (prompt) {
                  navigator.clipboard.writeText(prompt.prompt);
                  this.db.collection("prompts").doc(id).update({ copyCount: firebase.firestore.FieldValue.increment(1) });
                  this._showToast('å·²æˆåŠŸè¤‡è£½åˆ°å‰ªè²¼ç°¿ï¼');
              }
          } else if (e.target.closest('.edit')) {
              this._openPromptModal('edit', id);
          } else if (e.target.closest('.delete')) {
              if (confirm('ç¢ºå®šè¦åˆªé™¤é€™æ¢æç¤ºè©å—ï¼Ÿ')) {
                  this.db.collection("prompts").doc(id).delete();
                  this._showToast('æç¤ºè©å·²åˆªé™¤', 'error');
              }
          }
      }

      _openPromptModal(mode = 'add', id = null) {
        const { title, idInput, taskInput, categoryInput, promptInput, authorInput, historySelect } = this.elements.promptModal;
        this.isContentDirty = false; idInput.value = ''; taskInput.value = ''; promptInput.value = ''; authorInput.value = '';
        categoryInput.value = '';
        
        if (mode === 'edit') {
          const prompt = this.prompts.find(p => p.id === id);
          if (!prompt) return;
          title.textContent = 'ç·¨è¼¯æç¤ºè©'; idInput.value = prompt.id; taskInput.value = prompt.task;
          const categoryExists = this.categories.some(c => c.name === prompt.category);
          if (!categoryExists) {
              const tempOption = document.createElement('option');
              tempOption.value = prompt.category; tempOption.textContent = `${prompt.category} (å·²åˆªé™¤)`;
              categoryInput.appendChild(tempOption);
          }
          categoryInput.value = prompt.category; 
          promptInput.value = prompt.prompt; authorInput.value = prompt.author || '';
          this._populateHistory(prompt);
        } else {
          title.textContent = 'æ–°å¢æç¤ºè©';
          if(this.categories.length > 0) { categoryInput.value = this.categories[0].name; }
          historySelect.innerHTML = '<option value="">ç„¡æ­·å²ç‰ˆæœ¬</option>'; historySelect.disabled = true;
          authorInput.value = localStorage.getItem('promptLibraryAuthor') || '';
        }
        this._openModal(this.elements.promptModal.self); taskInput.focus();
      }

      _closePromptModal() {
        if (this.isContentDirty && !confirm('æ‚¨æœ‰æœªå„²å­˜çš„è®Šæ›´ï¼Œç¢ºå®šè¦é—œé–‰å—ï¼Ÿ')) { return; }
        this._closeModal(this.elements.promptModal.self);
      }

      async _savePrompt() {
          const { form, idInput, taskInput, categoryInput, promptInput, authorInput } = this.elements.promptModal;
          if (!form.checkValidity()) { form.reportValidity(); this._showToast("å„²å­˜å¤±æ•—ï¼šè«‹æª¢æŸ¥æ‰€æœ‰å¿…å¡«æ¬„ä½ï¼", "error"); return; }
          const id = idInput.value;
          const data = { task: taskInput.value.trim(), category: categoryInput.value, prompt: promptInput.value.trim(), author: authorInput.value.trim(), lastModified: new Date() };

          try {
            if (id) {
                const promptToUpdate = this.prompts.find(p => p.id === id);
                const oldHistory = promptToUpdate.history || [];
                oldHistory.unshift({ prompt: promptToUpdate.prompt, modifiedDate: promptToUpdate.lastModified, author: promptToUpdate.author });
                if (oldHistory.length > 10) oldHistory.pop();
                data.history = oldHistory;
                await this.db.collection("prompts").doc(id).update(data);
                this._showToast('æç¤ºè©å·²æ›´æ–°ï¼');
            } else {
                data.createdDate = new Date(); data.copyCount = 0; data.history = [];
                await this.db.collection("prompts").add(data);
                this._showToast('å·²æˆåŠŸæ–°å¢æç¤ºè©ï¼');
            }
            localStorage.setItem('promptLibraryAuthor', data.author);
            this.isContentDirty = false;
            this._closeModal(this.elements.promptModal.self);
          } catch(e) {
            console.error("å„²å­˜å¤±æ•—: ", e);
            this._showToast("å„²å­˜è‡³é›²ç«¯æ™‚ç™¼ç”ŸéŒ¯èª¤ã€‚", "error");
          }
      }
      
      _addNewCategory() {
          const { input } = this.elements.categoryModal; const newCat = input.value.trim();
          if (newCat && !this.categories.some(c => c.name === newCat)) {
              this.db.collection("categories").add({ name: newCat });
              input.value = ''; this._showToast('å·²æ–°å¢åˆ†é¡ï¼');
          } else { this._showToast(newCat ? 'åˆ†é¡å·²å­˜åœ¨' : 'åˆ†é¡åç¨±ä¸èƒ½ç‚ºç©º', 'error'); }
      }
      
      _deleteCategory(id) {
          if (confirm('ç¢ºå®šè¦åˆªé™¤é€™å€‹åˆ†é¡å—ï¼Ÿ')) {
            this.db.collection("categories").doc(id).delete();
            this._showToast('åˆ†é¡å·²åˆªé™¤', 'error');
          }
      }
      
      _restoreHistory(e) {
        const { idInput, promptInput, historySelect } = this.elements.promptModal;
        const id = idInput.value; const index = e.target.value;
        if (id && index !== '') {
            const prompt = this.prompts.find(p => p.id === id);
            const historicVersion = prompt.history[index];
            if (historicVersion && confirm('ç¢ºå®šè¦é‚„åŸåˆ°é€™å€‹æ­·å²ç‰ˆæœ¬å—ï¼Ÿ')) {
                promptInput.value = historicVersion.prompt; this._showToast('å·²é‚„åŸæ­·å²ç‰ˆæœ¬å…§å®¹ã€‚');
            }
            historySelect.value = '';
        }
      }

      _handleFileImport(event) {
        const file = event.target.files[0];
        if (!file) return;
        this.elements.importErrorContainer.style.display = 'none';
        const reader = new FileReader();
        reader.onload = (e) => this._processImportData(e.target.result);
        reader.onerror = () => {
            this._showToast("è®€å–æª”æ¡ˆå¤±æ•—ï¼", "error");
            this.elements.importErrorContainer.style.display = 'block';
        };
        reader.readAsText(file);
        event.target.value = null;
      }
      
      _handleManualImport(){
        const { textArea, self } = this.elements.manualImportModal;
        const content = textArea.value;
        if(this._processImportData(content)){
            this._closeModal(self);
        }
      }

      async _processImportData(jsonString){
        try {
            if(!jsonString) throw new Error("Input is empty.");
            const data = JSON.parse(jsonString);
            if (!data.prompts || !Array.isArray(data.prompts) || !data.categories || !Array.isArray(data.categories)) {
                throw new Error("Invalid file format: missing prompts or categories array.");
            }
            if (confirm(`ç¢ºå®šè¦å¾æª”æ¡ˆä¸­åŒ¯å…¥ ${data.prompts.length} æ¢æç¤ºè©èˆ‡ ${data.categories.length} å€‹åˆ†é¡å—ï¼Ÿ\næ­¤æ“ä½œåªæœƒæ–°å¢ï¼Œä¸æœƒåˆªé™¤ç¾æœ‰è³‡æ–™ã€‚`)) {
                await this._importDataToFirestore(data.prompts, data.categories);
            }
            return true;
        } catch (err) {
            this._showToast("æª”æ¡ˆæ ¼å¼éŒ¯èª¤æˆ–è§£æå¤±æ•—ï¼", "error");
            this.elements.importErrorContainer.style.display = 'block';
            console.error("Import processing error:", err);
            return false;
        }
      }

      async _importDataToFirestore(prompts, categories) {
        if (!this.db) return;
        this._showToast("æ­£åœ¨åŒ¯å…¥è³‡æ–™...");
        const batch = this.db.batch();
        
        const existingCategoryNames = this.categories.map(c => c.name);
        const newCategories = categories.filter(catName => !existingCategoryNames.includes(catName));
        newCategories.forEach(catName => {
            const catRef = this.db.collection("categories").doc();
            batch.set(catRef, { name: catName });
        });

        prompts.forEach(p => {
            const promptRef = this.db.collection("prompts").doc();
            batch.set(promptRef, {
                task: p.task || "ç„¡æ¨™é¡Œ", category: p.category || "æœªåˆ†é¡", prompt: p.prompt || "",
                author: p.author || "Imported", createdDate: new Date(), lastModified: new Date(),
                copyCount: p.copyCount || 0, history: []
            });
        });

        try {
            await batch.commit();
            this._showToast(`æˆåŠŸåŒ¯å…¥ ${prompts.length} æ¢æç¤ºè©èˆ‡ ${newCategories.length} å€‹æ–°åˆ†é¡ï¼`);
        } catch(err) {
            this._showToast("åŒ¯å…¥å¤±æ•—ï¼Œè«‹ç¨å¾Œå†è©¦ã€‚", "error");
            console.error("Import failed:", err);
            this.elements.importErrorContainer.style.display = 'block';
        }
      }

      _exportData() {
        try {
          const dataToExport = {
            version: "prompt-library-v1.0", exportedDate: new Date().toISOString(),
            prompts: this.prompts.map(({id, ...rest}) => rest),
            categories: this.categories.map(c => c.name)
          };
          const jsonString = JSON.stringify(dataToExport, null, 2);
          const blob = new Blob([jsonString], { type: 'application/json' });
          const url = URL.createObjectURL(blob);
          const a = document.createElement('a');
          const date = new Date().toISOString().split('T')[0];
          a.href = url; a.download = `prompt_library_backup_${date}.json`;
          document.body.appendChild(a); a.click();
          document.body.removeChild(a); URL.revokeObjectURL(url);
          this._showToast("è³‡æ–™å·²æˆåŠŸåŒ¯å‡ºï¼");
        } catch(e) { console.error("åŒ¯å‡ºå¤±æ•—:", e); this._showToast("åŒ¯å‡ºè³‡æ–™æ™‚ç™¼ç”ŸéŒ¯èª¤ã€‚", "error"); }
      }
      
      _showToast(message, type = 'success') {
        const toastContainer = document.getElementById('toastContainer');
        const toast = document.createElement('div');
        toast.className = `toast ${type}`; toast.textContent = message;
        toastContainer.appendChild(toast);
        setTimeout(() => toast.classList.add('show'), 10);
        setTimeout(() => { toast.classList.remove('show'); setTimeout(() => toast.remove(), 500); }, 3000);
      }
      
      _toggleClearSearchBtn() { this.elements.clearSearchBtn.style.display = this.elements.searchInput.value.length > 0 ? 'block' : 'none'; }
      
      _populateHistory(prompt) {
          const { historySelect } = this.elements.promptModal;
          historySelect.innerHTML = '<option value="">æª¢è¦–æ­·å²ç‰ˆæœ¬...</option>';
          if (prompt.history && prompt.history.length > 0) {
            prompt.history.forEach((h, index) => { 
                const date = h.modifiedDate.toDate ? h.modifiedDate.toDate() : new Date(h.modifiedDate);
                historySelect.innerHTML += `<option value="${index}">ç‰ˆæœ¬ #${prompt.history.length - index} (${date.toLocaleString()})</option>`;
            });
            historySelect.disabled = false;
          } else { historySelect.disabled = true; }
      }
    }

    document.addEventListener('DOMContentLoaded', () => {
      const app = new PromptLibraryApp();
      app.init();
    });
  </script>
</body>
</html>
